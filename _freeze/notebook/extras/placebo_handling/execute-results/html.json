{
  "hash": "cc48f34d07b3e7e6186b44221a7bc4bc",
  "result": {
    "engine": "knitr",
    "markdown": "# Placebo handling\n\nThis page showcase the model diagnosis and comparison for the E~max~ model \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(BayesERtools)\nlibrary(here)\n\ntheme_set(theme_bw(base_size = 12))\n```\n:::\n\n\n\n\n\n\n\n## Simulated data\n\n\n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd_sim_placebo\n```\n\n<pre class=\"r-output\"><code><span style='color: #555555;'># A tibble: 400 × 11</span>\n      id  dose exp_1 exp_2 rsp_1 rsp_2 cnt_a cnt_b cnt_c bin_d bin_e\n   <span style='color: #555555; font-style: italic;'><int></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span> <span style='color: #555555; font-style: italic;'><dbl></span>\n<span style='color: #555555;'> 1</span>     1     0     0     0  6.49     0  3.06  6.50 5.93      0     1\n<span style='color: #555555;'> 2</span>     2     0     0     0  7.81     0  5.72  3.84 5.60      0     1\n<span style='color: #555555;'> 3</span>     3     0     0     0  7.26     0  4.31  3.68 8.16      0     0\n<span style='color: #555555;'> 4</span>     4     0     0     0  7.45     0  4.03  2.86 9.38      1     1\n<span style='color: #555555;'> 5</span>     5     0     0     0  6.33     0  2.46  3.36 8.29      0     1\n<span style='color: #555555;'> 6</span>     6     0     0     0  7.13     0  4.87  8.90 7.06      0     0\n<span style='color: #555555;'> 7</span>     7     0     0     0  6.07     0  2.87  4.85 0.989     0     1\n<span style='color: #555555;'> 8</span>     8     0     0     0  5.47     1  1.07  5.34 3.34      1     1\n<span style='color: #555555;'> 9</span>     9     0     0     0  7.12     0  3.94  5.68 4.01      1     1\n<span style='color: #555555;'>10</span>    10     0     0     0  8.21     1  7.46  8.16 6.92      1     1\n<span style='color: #555555;'># ℹ 390 more rows</span>\n</code></pre>\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd_sim_placebo |> \n  pivot_longer(\n    cols = c(exp_1, cnt_a, cnt_b, cnt_c), \n    names_to = \"variable\",\n    values_to = \"value\"\n  ) |> \n  ggplot(aes(value, rsp_1)) + \n  geom_point(aes(color = factor(dose))) + \n  geom_smooth(formula = y ~ x, method = \"loess\") + \n  facet_wrap(~ variable, scales = \"free_x\")\n```\n\n::: {.cell-output-display}\n![](placebo_handling_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\n\n\n## Univariate models with placebo data\n\n### Linear E-R\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\nermod_lin <- dev_ermod_lin(\n  data = d_sim_placebo,\n  var_resp = \"rsp_1\",\n  var_exposure = \"exp_1\"\n)\nermod_lin\n```\n\n<pre class=\"r-output\"><code>\n<span style='color: #00BBBB;'>──</span> <span style='font-weight: bold;'>Linear ER model</span> <span style='color: #00BBBB;'>─────────────────────────────────────────────────────────────</span>\n<span style='color: #00BBBB;'>ℹ</span> Use `plot_er()` to visualize ER curve\n\n── <span style='font-weight: bold;'>Developed model</span> ──\n\nstan_glm\n family:       gaussian [identity]\n formula:      rsp_1 ~ exp_1\n observations: 400\n predictors:   2\n------\n            Median MAD_SD\n(Intercept) 10.12   0.17 \nexp_1        0.00   0.00 \nAuxiliary parameter(s):\n      Median MAD_SD\nsigma 2.35   0.09  \n------\n* For help interpreting the printed output see ?print.stanreg\n* For info on the priors used see ?prior_summary.stanreg\n</code></pre>\n\n```{.r .cell-code}\nplot_er(\n  ermod_lin, \n  show_orig_data = TRUE,\n  options_orig_data = list(var_group = \"dose\")\n)\n```\n\n::: {.cell-output-display}\n![](placebo_handling_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Binary E-R\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\nermod_bin <- dev_ermod_bin(\n  data = d_sim_placebo,\n  var_resp = \"rsp_2\",\n  var_exposure = \"exp_1\"\n)\nermod_bin\n```\n\n<pre class=\"r-output\"><code>\n<span style='color: #00BBBB;'>──</span> <span style='font-weight: bold;'>Binary ER model</span> <span style='color: #00BBBB;'>─────────────────────────────────────────────────────────────</span>\n<span style='color: #00BBBB;'>ℹ</span> Use `plot_er()` to visualize ER curve\n\n── <span style='font-weight: bold;'>Developed model</span> ──\n\nstan_glm\n family:       binomial [logit]\n formula:      rsp_2 ~ exp_1\n observations: 400\n predictors:   2\n------\n            Median MAD_SD\n(Intercept) -0.72   0.17 \nexp_1        0.00   0.00 \n------\n* For help interpreting the printed output see ?print.stanreg\n* For info on the priors used see ?prior_summary.stanreg\n</code></pre>\n\n```{.r .cell-code}\nplot_er(\n  ermod_bin, \n  show_orig_data = TRUE,\n  options_orig_data = list(var_group = \"dose\")\n)\n```\n\n::: {.cell-output-display}\n![](placebo_handling_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Emax continuous\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\nermod_emax <- dev_ermod_emax(\n  data = d_sim_placebo,\n  var_resp = \"rsp_1\",\n  var_exposure = \"exp_1\"\n)\nermod_emax\n```\n\n<pre class=\"r-output\"><code>\n<span style='color: #00BBBB;'>──</span> <span style='font-weight: bold;'>Emax model</span> <span style='color: #00BBBB;'>──────────────────────────────────────────────────────────────────</span>\n<span style='color: #00BBBB;'>ℹ</span> Use `plot_er()` to visualize ER curve\n\n── <span style='font-weight: bold;'>Developed model</span> ──\n\n---- Emax model fit with rstanemax ----\n         mean se_mean     sd    2.5%     25%     50%     75%   97.5%   n_eff\nemax     9.86     0.0   0.24    9.39    9.69    9.86   10.02   10.33 2838.13\ne0       7.42     0.0   0.12    7.18    7.34    7.42    7.50    7.65 2931.94\nec50  3565.63     6.3 321.32 2956.95 3345.30 3554.99 3776.59 4235.05 2605.08\ngamma    1.00     NaN   0.00    1.00    1.00    1.00    1.00    1.00     NaN\nsigma    1.22     0.0   0.04    1.14    1.19    1.22    1.25    1.31 3397.40\n      Rhat\nemax     1\ne0       1\nec50     1\ngamma  NaN\nsigma    1\n* Use `extract_stanfit()` function to extract raw stanfit object\n* Use `extract_param()` function to extract posterior draws of key parameters\n* Use `plot()` function to visualize model fit\n* Use `posterior_predict()` or `posterior_predict_quantile()` function to get\n  raw predictions or make predictions on new data\n* Use `extract_obs_mod_frame()` function to extract raw data \n  in a processed format (useful for plotting)\n</code></pre>\n\n```{.r .cell-code}\nplot_er(\n  ermod_emax, \n  show_orig_data = TRUE,\n  options_orig_data = list(var_group = \"dose\")\n)\n```\n\n::: {.cell-output-display}\n![](placebo_handling_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\n### Emax binary\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(1234)\nermod_bin_emax <- dev_ermod_bin_emax(\n  data = d_sim_placebo,\n  var_resp = \"rsp_2\",\n  var_exposure = \"exp_1\"\n)\nermod_bin_emax\n```\n\n<pre class=\"r-output\"><code>\n<span style='color: #00BBBB;'>──</span> <span style='font-weight: bold;'>Binary Emax model</span> <span style='color: #00BBBB;'>───────────────────────────────────────────────────────────</span>\n<span style='color: #00BBBB;'>ℹ</span> Use `plot_er()` to visualize ER curve\n\n── <span style='font-weight: bold;'>Developed model</span> ──\n\n---- Binary Emax model fit with rstanemax ----\n         mean se_mean      sd    2.5%     25%     50%     75%    97.5%   n_eff\nemax     3.97    0.02    0.63    2.88    3.55    3.92    4.34     5.37 1516.93\ne0      -1.26    0.01    0.24   -1.73   -1.41   -1.26   -1.10    -0.80 2028.42\nec50  6740.00   75.70 2984.78 2438.82 4617.45 6159.18 8237.01 14102.76 1554.48\ngamma    1.00     NaN    0.00    1.00    1.00    1.00    1.00     1.00     NaN\n      Rhat\nemax     1\ne0       1\nec50     1\ngamma  NaN\n* Use `extract_stanfit()` function to extract raw stanfit object\n* Use `extract_param()` function to extract posterior draws of key parameters\n* Use `plot()` function to visualize model fit\n* Use `extract_obs_mod_frame()` function to extract raw data \n  in a processed format (useful for plotting)\n</code></pre>\n\n```{.r .cell-code}\nplot_er(\n  ermod_bin_emax, \n  show_orig_data = TRUE,\n  options_orig_data = list(var_group = \"dose\")\n)\n```\n\n::: {.cell-output-display}\n![](placebo_handling_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "placebo_handling_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}